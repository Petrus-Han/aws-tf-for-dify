# Dify企业版AWS基础设施部署配置文件示例
# 复制此文件为 terraform.tfvars 并根据您的实际情况修改配置

# ──────────────── 基础配置 ────────────────
environment    = "test"  # 或 "prod"
aws_region     = "us-west-2"  # 根据您的实际区域修改
aws_account_id = "123456789012"  # 请修改为您的AWS账户ID

# ──────────────── 集群配置 ────────────────
cluster_name = "dify-eks-cluster"
cluster_version = "1.28"

# 节点组配置
node_group_instance_types = ["t3.large"]
node_group_desired_size   = 2
node_group_max_size      = 4
node_group_min_size      = 1

# ──────────────── 网络配置 ────────────────
# 如果使用现有VPC，请取消注释并填写实际值
use_existing_vpc = false
# vpc_id = "vpc-xxxxxxxxx"
# private_subnet_ids = ["subnet-xxxxxxxx", "subnet-yyyyyyyy"]
# public_subnet_ids  = ["subnet-aaaaaaaa", "subnet-bbbbbbbb"]

# 如果创建新VPC，配置以下参数
vpc_cidr = "10.0.0.0/16"
availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]

# ──────────────── 数据库配置 ────────────────
# Aurora PostgreSQL配置
db_instance_class = "db.r6g.large"
db_allocated_storage = 100
db_backup_retention_period = 7
db_backup_window = "03:00-04:00"

# ElastiCache Redis配置
redis_node_type = "cache.r6g.large"
redis_num_cache_nodes = 1
redis_parameter_group_name = "default.redis7"

# OpenSearch配置
opensearch_instance_type = "t3.small.search"
opensearch_instance_count = 1
opensearch_ebs_volume_size = 20

# ──────────────── 存储配置 ────────────────
# S3存储桶配置
s3_bucket_name = "dify-storage"  # 会自动添加随机后缀
s3_versioning_enabled = true

# ECR仓库配置
ecr_repository_name = "dify"
ecr_image_tag_mutability = "MUTABLE"

# ──────────────── Kubernetes基础组件 ────────────────
# Dify命名空间
dify_namespace = "dify"

# ──────────────── 可选组件 ────────────────
# AWS Load Balancer Controller（推荐启用）
install_aws_load_balancer_controller = true
aws_load_balancer_controller_version = "1.6.2"

# NGINX Ingress Controller（与ALB二选一）
install_nginx_ingress = false
nginx_ingress_version = "4.8.3"

# Cert-Manager（SSL证书管理）
install_cert_manager = true
cert_manager_version = "v1.13.2"



# ──────────────── 注意事项 ────────────────
# 1. 请修改 aws_account_id 为您的实际AWS账户ID
# 2. 请修改 aws_region 为您希望部署的AWS区域
# 3. 数据库密码直接在 rds.tf 和 opensearch.tf 文件中设置
# 4. 部署完成后，请按照 additional_docs 中的文档手工部署Dify应用